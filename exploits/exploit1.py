import requests
from datetime import date

def main():
    url = 'http://127.0.0.1:4444'
    username = 'user'
    password = '1'
    service_id_vip = 2
    r = requests.Session()
    csrf = r.get(url).cookies['csrftoken']
    user = dict(username=username,password1=password,password2=password,vip=True,csrfmiddlewaretoken=csrf)
    r.post(f'{url}/register',data=user).cookies['csrftoken']
    csrf = r.post(f'{url}/login',data={'username':username,'password':password,'csrfmiddlewaretoken':csrf}).cookies['csrftoken']
    appointment = dict()
    appointment['username'] = username
    appointment['appointment_date'] = date.today()
    appointment['csrfmiddlewaretoken'] = csrf
    appointment['service'] = service_id_vip
    r.post(f'{url}/appointment', data = appointment)
    
if __name__ == "__main__":
    main()
    